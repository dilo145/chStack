<script setup lang="ts">
import { ref } from "vue";
import {useRouter} from "vue-router";
const router = useRouter();

const drawer = ref(true);
const rail = ref(true);
const user = localStorage.getItem("user");
function disconnectUser() {
  localStorage.removeItem("user")
  router.push("/login")
}

</script>

<template>
  <!-- Conditional rendering of JSON data -->
  <v-card>
    <v-layout>
      <v-navigation-drawer
        v-model="drawer"
        :rail="rail"
        permanent
        @click="rail = false"
      >
        <v-divider></v-divider>

        <v-img
          v-if="!rail"
          src="../assets/logo.png"
          class="ma-2 w-50 mb-4"
        ></v-img>
        <v-img
          v-if="rail"
          src="../assets/small-logo.png"
          class="w-50 mx-auto ma-2"
        ></v-img>
        <v-list density="compact" nav>
          <v-list-item
            link
            to="/organisms"
            prepend-icon="mdi-account-group"
            title="Organisms"
            value="organisms"
          ></v-list-item>
          <v-list-item
            link
            to="/lessons"
            prepend-icon="mdi-school"
            title="Cours"
            value="lessons"
          ></v-list-item>
          <v-list-item
            link
            to="/classes"
            prepend-icon="mdi-school"
            title="Classes"
            value="classes"
          ></v-list-item>
          <v-list-item
            link
            to="/grades"
            prepend-icon="mdi-book-open-variant"
            title="Notes / Examen"
            value="grades"
          ></v-list-item>
          <v-list-item
            link
            to="/students"
            prepend-icon="mdi-account-group-outline"
            title="Etudiants"
            value="students"
          ></v-list-item>
          <v-list-item
            link
            to="/profile"
            prepend-icon="mdi-account"
            title="Mon Compte"
            value="account"
          ></v-list-item>
        </v-list>

        <template v-slot:append v-if="user">
          <v-btn color="error" class="text-center" variant="outlined" style="width: 45px;margin: auto;display: flex;justify-content: center" icon="mdi-logout" @click="disconnectUser"/>

          <div class="pa-2">
            <v-list-item
              prepend-avatar="https://randomuser.me/api/portraits/men/85.jpg"
              :title="`${user.firstName} ${user.lastName}`"
              nav
            >
              <template v-slot:append>
                <v-btn
                  icon="mdi-chevron-left"
                  variant="text"
                  @click.stop="rail = !rail"
                ></v-btn>
              </template>
            </v-list-item>
          </div>
        </template>
      </v-navigation-drawer>
      <v-main style="height: 100vh"></v-main>
    </v-layout>

  </v-card>
</template>
